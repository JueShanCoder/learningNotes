# JVM
## JVM 内存

![](https://box.kancloud.cn/8a541a860d5224d8600f0033eba1422c_605x467.jpg)

JVM内存区域主要分为线程私有区域【程序计数器、虚拟机栈、本地方法区】、线程共享区域【Java堆、方法区】、直接内存。
- 线程私有数据区域生命周期与线程相同，依赖用户线程的启动/结束而创建/销毁。
- 线程共享区域随虚拟机的启动/关闭而创建/销毁。
- 直接内存并不是JVM运行时数据区的一部分，但也会频繁的使用。在JDK1.4引入的NIO提供了基于Channel与Buffer的IO方式,它可以使用Native函数库直接分配堆
外内存,然后使用DirectByteBuffer对象作为这块内存的引用进行操作。

![](https://box.kancloud.cn/4e394e6496424148e28cceff0de8c460_605x397.jpg)

### 程序计数器（线程私有）
一块较小的内存空间，是当前线程所执行的字节码的行号指示器，每条线程都要有一个独立的程序计数器，这类内存也称为"线程私有"的内存。
- 正在执行java方法的话，计数器记录的是虚拟机字节码指令的地址（当前指令的地址），如果还是native方法，则为空。
- 这个内存区域是唯一一个在虚拟机中没有规定任何OutOfMemoryError情况的区域。

### 虚拟机栈（线程私有）
是描述java方法执行的内存模型，每个方法在执行的同时都会创建一个栈帧（Stack Frame）用于存储局部变量表、操作数栈、动态链接、方法出口等信息。每一个
方法从调用直至执行完成的过程，就对应着一个栈帧在虚拟机栈中入栈到出栈的过程。

![](https://box.kancloud.cn/aa2081a0788d7b93eb61038a19b142fd_407x403.png)





