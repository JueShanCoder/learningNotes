#  Java并发编程

## 什么是乐观锁和悲观锁
- 悲观锁：嘉定会发生并发冲突，独占锁，屏蔽一切可能违反数据完整性的操作。
- 乐观锁：假设不会发生并发冲突，只在提交操作时检查是否违反数据完整性。乐观锁不能解决脏读的问题。

### 乐观锁
- 乐观锁是一种乐观思想，即认为读多写少，遇到并发写的可能性低，每次去拿数据的时候都认为别人不会修改，所以不会上锁，只有在更新时候才回去检查，采取在
写时先读出当前版本号，然后加锁操作，Java中的乐观锁基本都是通过CAS操作实现，CAS是一种更新的原子操作，比较当前值跟传入值是是否一样，一样则更新，否则
  失败。
  
### 悲观锁
- 悲观锁是就是悲观思想，即认为写多，遇到并发写的可能性高，每次去拿数据的时候都认为别人会修改，所以每次在读写数据的时候都会上锁，这样别人想读写这个数
  据就会 block 直到拿到锁。
java 中的悲观锁就是Synchronized,AQS 框架下的锁则是先尝试 cas 乐观锁去获取锁，获取不到，才会转换为悲观锁，如 RetreenLock 。

### 自旋锁
- 自旋锁的原理非常简单，如果持有锁的线程能在很短时间内释放锁资源，那么那些等待竞争锁的线程就不需要做内核态和用户态之间的切换进入阻塞挂起状态，它们
  只需要等一等（自旋），等持有锁的线程释放锁后即可立即获取锁，这样就避免用户线程和内核的切换的消耗。




